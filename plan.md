以下是根據你提供的逐字稿，整理成清晰的「主管需求說明流程」與「開發／設計 To-Do 清單」：

---

## 一、整體說明（主管口述摘要）

整個「訂單畫面」的功能主要針對**服務商端**與**客戶端**之間的互動，包含下單、接單、退單、續約與結束確認。
所有金流以「點數（鑽石帳戶）」形式處理，退單及罰款皆由後台決定金額。

---

## 二、流程拆解

### 1️⃣ 下單與待確認階段

* 客戶下單後 → 訂單狀態為「待確認」。
* 客戶可在此階段**選擇退單／取消**，需填寫原因。
* 系統送審 → **後台管理員審核**後：

  * 退還點數至客人鑽石帳戶。
  * 若不符條件，後台可設定**違約金／罰款差額**。

**服務商操作：**

* 在「待確認」狀態可：

  * 接單（確認接受）。
  * 不接單（退單／拒絕）。

---

### 2️⃣ 待執行階段

* 狀態由「待確認」→「待執行」。
* 客戶仍有退單權利。
* 服務商可在此階段確認「是否報到」與「退單」。

---

### 3️⃣ 進行中階段

* 客戶可：

  * 按「開始」 → 開始計時。
  * 或選「退單」。
* 若服務商遲到，客戶仍可退單。

**特例：**

* 若客戶要求「續時間」：

  * 系統會產生**第二張續約訂單**。
  * 直接扣除點數，無最低時數限制。
  * 新單號與原單號只差一碼。
  * 丟給服務商再次確認是否接單。
  * 一旦接單 → 直接接續執行。

---

### 4️⃣ 服務商幫客人續約

* 進行中時，**服務商可主動幫客人續單**（例如客人喝醉或無法操作）。
* 流程：

  * 服務商建立新訂單 → 客人確認或退單。
  * 若客人確認 → 系統補進第二張單 → 繼續計時。

---

### 5️⃣ 結束階段

* 服務完成後，客戶端顯示「確認結束」按鈕。
* 若客人未按，系統**自動判定結束**。
* 「取消」選項移除，統一以「退單」處理。
* 後台負責審核退點或扣罰款。

---

## 三、開發／設計 To-Do 清單

| 類別        | 項目      | 說明                                           |
| --------- | ------- | -------------------------------------------- |
| **UI/UX** | 訂單狀態標籤  | 顯示四階段：「待確認」、「待執行」、「進行中」、「已結束」                |
|           | 服務商端操作區 | 待確認：顯示「接單」「退單」按鈕；待執行：顯示「報到」「退單」；進行中：顯示「續約」按鈕 |
|           | 客戶端操作區  | 待確認與待執行可「退單」；進行中可「開始」「退單」「續約」；結束後顯示「確認結束」    |
|           | 退單視窗    | 包含退單原因下拉＋文字輸入區                               |
|           | 結束確認    | 若未點擊，系統自動完成                                  |
| **後台管理**  | 退單審核    | 可決定退回點數金額／違約金比例                              |
|           | 鑽石帳戶管理  | 處理退回／扣除點數邏輯                                  |
|           | 訂單記錄    | 顯示原單號與續約單號關聯（差一碼）                            |
| **系統邏輯**  | 續約機制    | 生成第二張單、保留原資料、直接扣點、服務商再確認                     |
|           | 自動結束邏輯  | 若時間到或未確認，系統自動改為「已結束」                         |
|           | 狀態流轉控制  | 待確認 → 待執行 → 進行中 → 已結束                        |
| **資料庫設計** | 訂單關聯欄位  | parent_order_id 或續約關聯欄                       |
|           | 退單原因欄   | 儲存客戶輸入的退單理由文字                                |
|           | 罰款與退點欄位 | 由後台審核更新                                      |

---

## 四、補充備註

* 所有「退單」統一流程與按鈕文字。
* 「取消」選項移除。
* 點數與罰款運算皆由後台控制，前端僅顯示狀態。
* UI 上須明確區分**客戶端／服務商端**功能。

